<%= turbo_stream_from @coffee_bean %>

<div class="flex items-center justify-between mb-4">
  <h1 class="title"><%= @coffee_bean.display_name %></h1>
  <% if @coffee_bean.generated? %>
    <%= render "shared/publish_dropdown", record: @coffee_bean %>
  <% end %>
</div>

<% if @coffee_bean.images.attached? %>
  <div class="flex gap-2">
    <% @coffee_bean.images.each do |image| %>
      <%= image_tag image.variant(resize_to_fill: [384, 384]), class: "h-48 w-48 object-cover rounded" %>
    <% end %>
  </div>
<% end %>

<%= render "details", coffee_bean: @coffee_bean %>

<% if @coffee_bean.generated? %>
  <% all_recipes = (@coffee_bean.aeropress_recipes + @coffee_bean.v60_recipes).sort_by(&:created_at).reverse %>
  <%= render "recipes/list", recipes: all_recipes, coffee_bean: @coffee_bean, title: "Recipes" %>

  <div>
    <h2 class="font-bold text-xl">Generate Recipe</h2>
    <%= render "recipes/form", coffee_bean: @coffee_bean %>
  </div>
<% end %>

<div class="mt-8">
  <%= button_to "Delete Coffee Bean", @coffee_bean, method: :delete, data: { turbo_confirm: "Are you sure you want to delete this coffee bean?" }, class: "px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700" %>
</div>

